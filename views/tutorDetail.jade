html 
    head
        title Tutor Profile Detail
        link(rel='stylesheet', href='/stylesheets/tutorDetail.css')
        script(src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js")
    body 
        nav(class="nav")
                div(class="menu_group")
                    div(class="home")
                        a(href="../")
                            img(src="https://i.ibb.co/ZSJQwCr/home-page.pngg" alt="home" style="width:30px;height:30px;")
                    div(class="current")
                        a(id="1" href="./") 튜터 찾기
                    div(class="other")
                        a(id="2" href="../post/") 질문/답변
                    div(class="other") 
                        a(id="3" href="../findPost/") 찾아요
                    div(class="other")
                        a(id="4" href="../tutoringList/") 멘토링 목록
                    div(class="other")
                        a(id="5" href="../requestList/") 받은 요청
                    div(class="other")
                        a(id="6" href="../sendList/") 보낸 요청
        div(class="profileBox")
            div(class="profileArea")
                div(class="ImageSector")
                    img(src="https://ajoring.kr/"+"#{rows[0].profileImage}" class="image")
                    div(class="nickname")
                        h4 #{rows[0].nickname}
                    div(class="email")
                        h4 #{rows[0].email}
                div(class="requestButton")
                    button(onClick="openModal()") 
                        h4 요청하기
                div(class="translate" style="margin-left:auto;")
                    img(id="en" src="https://i.ibb.co/ws69Xdc/united-states-of-america.png" style="margin-right:10px;width:25px;height:25px;" onClick="translateTo(this.id)")
                    img(id="zh-CN" src="https://i.ibb.co/6JY4t20/china.png" style="margin-right:10px;width:25px;height:25px;" onClick="translateTo(this.id)")
                    img(id="vi" src="https://i.ibb.co/yp5C8MF/vietnam.png" style="margin-right:10px;width:25px;height:25px;" onClick="translateTo(this.id)")
                div(class="UserSector")
                    div(class="tutorIntroduce")
                        h3 소개
                        h4 #{rows[0].Introduce}
                    div(class="department")
                        h3 튜터 분야
                        h4 #{rows[0].tutorSector}
                    div(class="userType")
                        h3 튜터링 날짜
                        h4 #{rows[0].tutorDates}
                    div(class="userType2")
                        h3 선호 언어
                        h4 #{rows[0].preferenceCountry}
        div(class="myProfile")
            img(src="https://ajoring.kr/"+"#{user.profileImage}" class="profileIcon")
            a(id="7" href="../myProfile/") 내 프로필
        div(id="modal" class="modal-overlay")
                div(class="modal-window")
                    div(class="modal-top")
                        div(class="modal-textarea")
                            h4 튜터링 요청사항
                            textarea(id="modal-text")
                        div(class="close-area" onClick="closeModal()") X
                    div(class="modal-bottom")
                        button(onClick="sendMatching()")
                            h2 매칭 요청
    script(type="text/javascript").
        var text = document.querySelector('div.menu_group').innerText;
        var requestBtn = document.querySelector('div.requestButton button h4').innerHTML;
        var myProfile = document.querySelector('div.myProfile a').innerText;
        var introduce = document.querySelector('div.tutorIntroduce h3').innerHTML;
        var department = document.querySelector('div.department h3').innerHTML;
        var userType = document.querySelector('div.userType h3').innerHTML;
        var userType2 = document.querySelector('div.userType2 h3').innerHTML;
        var textarea = document.querySelector('div.modal-textarea h4').innerHTML;
        var bottom = document.querySelector('div.modal-bottom button h2').innerHTML;
        var lang = "#{user.country}"
            if(lang=="China") lang = 'zh-CN';
            else if(lang=="Vietnam") lang = 'vi';

        const openModal = () => {
            const modal = document.getElementById("modal");
            modal.style.display = "flex";
        }
        const closeModal = () => {
            const modal = document.getElementById("modal");
            modal.style.display = "none";
        }
        const sendMatching = () => {
            const targetUser = document.location.href.substring(document.location.href.indexOf('?')+1).split('=')[1];
            const comment = document.getElementById('modal-text').value;
            if(targetUser!="#{user.id}") {
                axios.get('https://ajoring.kr/tutoring/request',{
                        method: 'POST',
                        params: {
                            targetUser : targetUser,
                            comment : comment
                        },
                        headers: {
                            'Content-Type': 'application/json',
                        },
                }).then(response => {
                    if(response.data.status==200) {
                        const modal = document.getElementById("modal");
                        modal.style.display = "none";
                        alert('send success!');
                        document.location.href = './';
                    }
                })
            } else {
                alert("Can't Send!");
            }
        }
        const testTrans = () => {
                axios.get('https://ajoring.kr/translate',{
                    method: 'POST',
                    params: {
                        target : lang,
                        text : text + '\n' + requestBtn + '\n' + myProfile + '\n' + introduce + '\n' + department + '\n' + userType + '\n' + userType2 + '\n' + textarea + '\n' + bottom
                    },
                    headers: {
                        'Content-Type': 'application/json',
                    },
                }).then(response=> {
                    var list = response.data.message.result.translatedText.split('\n');
                    for(var i = 1; i<= 6; i++) {
                        document.getElementById(i).textContent = list[i-1];
                    }
                    requestBtn = document.querySelector('div.requestButton button h4').innerHTML = list[6];
                    document.querySelector('div.myProfile a').innerText = list[7];
                    document.querySelector('div.tutorIntroduce h3').innerHTML = list[8];
                    document.querySelector('div.department h3').innerHTML = list[9];
                    document.querySelector('div.userType h3').innerHTML = list[10];
                    document.querySelector('div.userType2 h3').innerHTML = list[11];
                    document.querySelector('div.modal-textarea h4').innerHTML = list[12];
                    document.querySelector('div.modal-bottom button h2').innerHTML = list[13];
                })
        }
        const translateTo = (id) => {
            var introduceText = document.querySelector('div.tutorIntroduce h4').innerHTML;
            var departmentText = document.querySelector('div.department h4').innerHTML;
            var userTypeText = document.querySelector('div.userType h4').innerHTML;
            var userType2Text = document.querySelector('div.userType2 h4').innerHTML;
            axios.get('https://ajoring.kr/detect',{
                    method: 'POST',
                    params: {
                        text : introduceText
                    },
                    headers: {
                        'Content-Type': 'application/json',
                    },
                }).then(response=> {
                    if(response.data.langCode=='ko') {
                        axios.get('https://ajoring.kr/innerTranslate',{
                        method: 'POST',
                        params: {
                            source : response.data.langCode,
                            target : id,
                            text : introduceText + '\n' + departmentText + '\n' + userTypeText + '\n' + userType2Text
                        },
                        headers: {
                            'Content-Type': 'application/json',
                        },
                    }).then(response2=> {
                        var list = response2.data.message.result.translatedText.split('\n');
                        document.querySelector('div.tutorIntroduce h4').innerHTML = list[0];
                        document.querySelector('div.department h4').innerHTML = list[1];
                        document.querySelector('div.userType h4').innerHTML = list[2];
                        document.querySelector('div.userType2 h4').innerHTML = list[3];
                    })
                    } else {
                        axios.get('https://ajoring.kr/innerTranslate',{
                            method: 'POST',
                            params: {
                                source : response.data.langCode,
                                target : 'ko',
                                text : introduceText + '\n' + departmentText + '\n' + userTypeText + '\n' + userType2Text
                            },
                            headers: {
                                'Content-Type': 'application/json',
                            },
                        }).then(response3=> {
                            var list = response3.data.message.result.translatedText.split('\n');
                            document.querySelector('div.tutorIntroduce h4').innerHTML = list[0];
                            document.querySelector('div.department h4').innerHTML = list[1];
                            document.querySelector('div.userType h4').innerHTML = list[2];
                            document.querySelector('div.userType2 h4').innerHTML = list[3];
                            axios.get('https://ajoring.kr/innerTranslate',{
                            method: 'POST',
                            params: {
                                source : 'ko',
                                target : id,
                                text : introduceText + '\n' + departmentText + '\n' + userTypeText + '\n' + userType2Text
                            },
                            headers: {
                                'Content-Type': 'application/json',
                            },
                        }).then(response4=> {
                            var list = response4.data.message.result.translatedText.split('\n');
                            document.querySelector('div.tutorIntroduce h4').innerHTML = list[0];
                            document.querySelector('div.department h4').innerHTML = list[1];
                            document.querySelector('div.userType h4').innerHTML = list[2];
                            document.querySelector('div.userType2 h4').innerHTML = list[3];
                        })
                        })
                        
                    }
            })
        }
        testTrans();
